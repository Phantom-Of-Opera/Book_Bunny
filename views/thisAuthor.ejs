<%-include("partials/header.ejs") %>

<div class="container my-3 scrollable">
	<div class="row align-items-start border-bottom" style="flex: 1 1 auto">
		<!-- Author Picture -->
		<div class="col-12 col-md-3" style="text-align: center">
			<picture>
				<!-- Medium size for small screens -->
				<source
					srcset="
						//covers.openlibrary.org/a/id/<%=locals.thisAuthor.author_wikidata%>-M.jpg
					"
					media="(max-width: 768px)"
				/>
				<!-- Large size for larger screens -->
				<source
					srcset="
						//covers.openlibrary.org/a/id/<%=locals.thisAuthor.author_wikidata%>-L.jpg
					"
					media="(min-width: 769px)"
				/>
				<!-- Fallback image -->
				<img <% if (locals.thisAuthor.author_wikidata == null) { %>
				src="images/blank_cover.jpeg" <% } else { %>
				src="https://covers.openlibrary.org/b/olid/<%=
				locals.thisAuthor.author_wikidata%>-L.jpg" <% } %> alt="Author Picture"
				class="img-fluid" />
			</picture>

			<!-- Star rating system -->
			<div class="star-rating interactive">
				<input
					type="hidden"
					name="author_rating"
					id="author_rating"
					value="<%= locals.thisAuthor.author_rating || 0 %>"
				/>
				<% for (let i = 1; i <= 5; i++) { %>
				<i
					class="bi <%= i <= locals.thisAuthor.author_rating ? 'bi-star-fill' : 'bi-star' %>"
					data-value="<%= i %>"
				></i>
				<% } %>
			</div>
		</div>

		<!--TODO:Update the author info-->
		<!-- Author Info -->
		<div class="col-12 col-md-9" id="bookInfoCol">
			<div>
				<h2 class="simonetta-black fontFlex-h2" style="text-align: left">
					<%=locals.thisAuthor.author_name%>
					<span style="font-size: small"
						>(<%=locals.thisAuthor.author_birth_date%> /
						<%=locals.thisAuthor.author_death_date%>)</span
					>
				</h2>

				<!-- Add a div to get h3 on the left of the screen and the button on the right on the same line -->
				<div
					class="d-flex justify-content-between align-items-center mt-2"
					style="flex-wrap: wrap"
				>
					<button
						type="button"
						class="btn btn-secondary d-flex align-items-center fontFlex"
						id="toggleDescription"
					>
						<span id="toggleText">Hide Description</span>
						<i
							class="bi bi-chevron-down ms-2 toggle-icon rotated"
							id="descIcon"
							style="color: white"
						></i>
					</button>
				</div>
				<p
					class="fontFlex simonetta-regular-italic slide open mt-2"
					id="bookDescription"
				>
					<%=locals.thisAuthor.author_top_work%>
				</p>
			</div>

			<!-- TODO: Change the author area. If I want to put notes about and author, I need to add a authors_readers database-->
			<div id="bookArea">
				<form
					action="/authors"
					method="GET"
					style="display: flex; flex-direction: column; height: 100%"
					id="bookAnalysisForm"
				>
					<div
						class="d-flex justify-content-between align-items-center my-2"
						style="flex-wrap: wrap"
					>
						<h3 class="simonetta-black fontFlex-h3" style="text-align: left">
							My author notes
						</h3>

						<div>
							<button type="button" class="btn fontFlex" id="btnSave">
								Save
							</button>
							<button type="submit" class="btn fontFlex" id="btnCancel">
								Cancel
							</button>
						</div>
					</div>
					<div class="mb-3 scrollable">
						<div
							id="quillEditor"
							class="form-control simonetta-regular"
							style="height: 90%; font-size: 1rem"
						>
							<%- thisAuthor.author_notes%>
						</div>
						<input type="hidden" name="authorNotes" id="authorNotes" />
						<input type="hidden" name="authorRating" id="authorRating" />

						<input
							type="hidden"
							name="authorId"
							id="authorId"
							value="<%= locals.thisAuthor.id_author %>"
						/>
						<input
							type="hidden"
							name="userId"
							id="userId"
							value="<%= locals.thisAuthor.id_reader %>"
						/>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<%-include("partials/footer.ejs") %>
